name: Daily Market Analysis

on:
  schedule:
    - cron: "0 13 * * 1-5"  # 13:00 UTC —É –±—É–¥–Ω—ñ –¥–Ω—ñ
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: ‚¨áÔ∏è –ö–ª–æ–Ω —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é
        uses: actions/checkout@v3

      - name: ‚öôÔ∏è –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è Python
        uses: actions/setup-python@v4
        with:
          python-version: "3.10"

      - name: üì¶ –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π (—è–∫—â–æ —î)
        run: pip install -r requirements.txt || true

      - name: üõ†Ô∏è –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è HTML
        run: python generate.py

      - name: üîë –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è git
        run: |
          git config --global user.name "GitHub Actions"
          git config --global user.email "actions@github.com"

      - name: üîÅ –ö–æ–º—ñ—Ç —ñ –ø—É—à
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
        run: |
          git remote set-url origin https://x-access-token:${GH_TOKEN}@github.com/${{ github.repository }}
          python update.py
